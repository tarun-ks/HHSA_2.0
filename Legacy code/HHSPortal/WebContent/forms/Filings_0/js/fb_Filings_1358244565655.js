//This method launches the alert box
function AlertObject(name, id, type, value,elementId){this.name = name ; this.type = type ;this.value = value ;this.id = id ;this.elementId = elementId ;}var arr = new Array() ;arr[arr.length] = arr['dropdownElt11340776947637dIi15v_select']= [new AlertObject('alert1','alert1','m','! This field is required.','dropdownElt11340776947637dIi15v_select')];arr[arr.length] = arr['errorIndElt11345880126552dIi15v_errorInd']= [new AlertObject('alert1','alert1',' ',' ','errorIndElt11345880126552dIi15v_errorInd')];arr[arr.length] = arr['checkboxElt11340778636849dIi15v_checkbox']= [new AlertObject('alert1','alert1','nm','! This field is required.','checkboxElt11340778636849dIi15v_checkbox')];arr[arr.length] = arr['checkboxElt21340778702944dIi15v_checkbox']= [new AlertObject('alert1','alert1','nm','Educational_Institute','checkboxElt21340778702944dIi15v_checkbox')];arr[arr.length] = arr['checkboxElt21340779203866dIi15v_checkbox']= [new AlertObject('alert1','alert1','nm','Historical_Societies','checkboxElt21340779203866dIi15v_checkbox')];arr[arr.length] = arr['checkboxElt21340779008559dIi15v_checkbox']= [new AlertObject('alert1','alert1','nm','Patriotic','checkboxElt21340779008559dIi15v_checkbox')];arr[arr.length] = arr['errorIndElt1345880203797dIi15v_errorInd']= [new AlertObject('alert1','alert1',' ',' ','errorIndElt1345880203797dIi15v_errorInd')];arr[arr.length] = arr['checkboxElt11340779531757dIi15v_checkbox']= [new AlertObject('alert1','alert1','nm','Relief','checkboxElt11340779531757dIi15v_checkbox')];arr[arr.length] = arr['checkboxElt11340781903926dIi15v_checkbox']= [new AlertObject('alert1','alert1','nm','other_exempt','checkboxElt11340781903926dIi15v_checkbox')];arr[arr.length] = arr['textareaElt11340782345692dIi15v_textarea']= [new AlertObject('alert1','alert1','m','! This field is required.','textareaElt11340782345692dIi15v_textarea')];arr[arr.length] = arr['errorIndElt1345880204042dIi15v_errorInd']= [new AlertObject('alert1','alert1',' ',' ','errorIndElt1345880204042dIi15v_errorInd')];arr[arr.length] = arr['textboxElt11340783082325dIi15v_textbox']= [new AlertObject('alert1','alert1','m','! This field is required.','textboxElt11340783082325dIi15v_textbox'),new AlertObject('alert2','alert2','a','Organizations Registration ID field is Mandatory. Please fill to proceed.','textboxElt11340783082325dIi15v_textbox')];arr[arr.length] = arr['errorIndElt1345880204363dIi15v_errorInd']= [new AlertObject('alert1','alert1',' ',' ','errorIndElt1345880204363dIi15v_errorInd')];arr[arr.length] = arr['dropdownElt11340783350449dIi15v_select']= [new AlertObject('alert1','alert1','m','! This field is required.','dropdownElt11340783350449dIi15v_select')];arr[arr.length] = arr['errorIndElt1345880204605dIi15v_errorInd']= [new AlertObject('alert1','alert1',' ',' ','errorIndElt1345880204605dIi15v_errorInd')];arr[arr.length] = arr['errorIndElt1345880204824dIi15v_errorInd']= [new AlertObject('alert1','alert1',' ',' ','errorIndElt1345880204824dIi15v_errorInd')];arr[arr.length] = arr['checkboxElt11340783635273dIi15v_checkbox']= [new AlertObject('alert1','alert1','nm','! This field is required.','checkboxElt11340783635273dIi15v_checkbox')];arr[arr.length] = arr['radiogroupElt11340784181694dIi15v_radio']= [new AlertObject('alert1','alert1','m','! This field is required.','radiogroupElt11340784181694dIi15v_radio')];arr[arr.length] = arr['radiogroupElt21340784265528dIi15v_radio']= [new AlertObject('alert1','alert1','m','! This field is required.','radiogroupElt21340784265528dIi15v_radio')];arr[arr.length] = arr['errorIndElt1345880205017dIi15v_errorInd']= [new AlertObject('alert1','alert1',' ',' ','errorIndElt1345880205017dIi15v_errorInd')];arr[arr.length] = arr['radiogroupElt21340784627848dIi15v_radio']= [new AlertObject('alert1','alert1','m','! This field is required.','radiogroupElt21340784627848dIi15v_radio')];arr[arr.length] = arr['errorIndElt1345880205236dIi15v_errorInd']= [new AlertObject('alert1','alert1',' ',' ','errorIndElt1345880205236dIi15v_errorInd')];arr[arr.length] = arr['dropdownElt11340785885294dIi15v_select']= [new AlertObject('alert1','alert1','m','! This field is required.','dropdownElt11340785885294dIi15v_select')];arr[arr.length] = arr['radiogroupElt11340786346970dIi15v_radio']= [new AlertObject('alert1','alert1','m','! This field is required.','radiogroupElt11340786346970dIi15v_radio')];arr[arr.length] = arr['errorIndElt1345880205388dIi15v_errorInd']= [new AlertObject('alert1','alert1',' ',' ','errorIndElt1345880205388dIi15v_errorInd')];arr[arr.length] = arr['radiogroupElt21340786404448dIi15v_radio']= [new AlertObject('alert1','alert1','m','! This field is required.','radiogroupElt21340786404448dIi15v_radio')];arr[arr.length] = arr['radiogroupElt21340786592618dIi15v_radio']= [new AlertObject('alert1','alert1','m','! This field is required.','radiogroupElt21340786592618dIi15v_radio')];arr[arr.length] = arr['dropdownElt11340787157168dIi15v_select']= [new AlertObject('alert1','alert1','m','! This field is required.','dropdownElt11340787157168dIi15v_select')];arr[arr.length] = arr['errorIndElt1345880205544dIi15v_errorInd']= [new AlertObject('alert1','alert1',' ',' ','errorIndElt1345880205544dIi15v_errorInd')];arr[arr.length] = arr['textareaElt1340788255147dIi15v_textarea']= [new AlertObject('alert1','alert1','m','! This field is required.','textareaElt1340788255147dIi15v_textarea')];arr[arr.length] = arr['errorIndElt1345880205757dIi15v_errorInd']= [new AlertObject('alert1','alert1',' ',' ','errorIndElt1345880205757dIi15v_errorInd')];arr[arr.length] = arr['radiogroupElt11340788852126dIi15v_radio']= [new AlertObject('alert1','alert1','m','! This field is required.','radiogroupElt11340788852126dIi15v_radio')];arr[arr.length] = arr['radiogroupElt21340788900360dIi15v_radio']= [new AlertObject('alert1','alert1','m','! This field is required.','radiogroupElt21340788900360dIi15v_radio')];arr[arr.length] = arr['errorIndElt1345880206025dIi15v_errorInd']= [new AlertObject('alert1','alert1',' ',' ','errorIndElt1345880206025dIi15v_errorInd')];arr[arr.length] = arr['radiogroupElt1340789283352dIi15v_radio']= [new AlertObject('alert1','alert1','m','! This field is required.','radiogroupElt1340789283352dIi15v_radio')];arr[arr.length] = arr['radiogroupElt1340789454638dIi15v_radio']= [new AlertObject('alert1','alert1','m','! This field is required.','radiogroupElt1340789454638dIi15v_radio')];arr[arr.length] = arr['dropdownElt11340789748055dIi15v_select']= [new AlertObject('alert1','alert1','m','! This field is required.','dropdownElt11340789748055dIi15v_select')];arr[arr.length] = arr['errorIndElt1345880206305dIi15v_errorInd']= [new AlertObject('alert1','alert1',' ',' ','errorIndElt1345880206305dIi15v_errorInd')];arr[arr.length] = arr['errorIndElt1345880206405dIi15v_errorInd']= [new AlertObject('alert1','alert1',' ',' ','errorIndElt1345880206405dIi15v_errorInd')];arr[arr.length] = arr['radiogroupElt11340791887124dIi15v_radio']= [new AlertObject('alert1','alert1','m','! This field is required.','radiogroupElt11340791887124dIi15v_radio')];arr[arr.length] = arr['radiogroupElt21340791896885dIi15v_radio']= [new AlertObject('alert1','alert1','m','! This field is required.','radiogroupElt21340791896885dIi15v_radio')];arr[arr.length] = arr['errorIndElt1345880206475dIi15v_errorInd']= [new AlertObject('alert1','alert1',' ',' ','errorIndElt1345880206475dIi15v_errorInd')];arr[arr.length] = arr['dropdownElt1340792805081dIi15v_select']= [new AlertObject('alert1','alert1','m','! This field is required.','dropdownElt1340792805081dIi15v_select')];arr[arr.length] = arr['textareaElt1340792526857dIi15v_textarea']= [new AlertObject('alert1','alert1','m','! This field is required.','textareaElt1340792526857dIi15v_textarea')];arr[arr.length] = arr['errorIndElt1345880545036dIi15v_errorInd']= [new AlertObject('alert1','alert1',' ',' ','errorIndElt1345880545036dIi15v_errorInd')];arr[arr.length] = arr['dropdownElt1340793157977dIi15v_select']= [new AlertObject('alert1','alert1','m','! This field is required.','dropdownElt1340793157977dIi15v_select')];arr[arr.length] = arr['errorIndElt1345880545343dIi15v_errorInd']= [new AlertObject('alert1','alert1',' ',' ','errorIndElt1345880545343dIi15v_errorInd')];arr[arr.length] = arr['textareaElt1340793415886dIi15v_textarea']= [new AlertObject('alert1','alert1','m','! This field is required.','textareaElt1340793415886dIi15v_textarea')];arr[arr.length] = arr['errorIndElt1345880545787dIi15v_errorInd']= [new AlertObject('alert1','alert1',' ',' ','errorIndElt1345880545787dIi15v_errorInd')];arr[arr.length] = arr['errorIndElt1345880545896dIi15v_errorInd']= [new AlertObject('alert1','alert1',' ',' ','errorIndElt1345880545896dIi15v_errorInd')];arr[arr.length] = arr['dropdownElt1340794397338dIi15v_select']= [new AlertObject('alert1','alert1','m','! This field is required.','dropdownElt1340794397338dIi15v_select')];arr[arr.length] = arr['dropdownElt1340794655699dIi15v_select']= [new AlertObject('alert1','alert1','m','! This field is required.','dropdownElt1340794655699dIi15v_select')];arr[arr.length] = arr['errorIndElt1345880546404dIi15v_errorInd']= [new AlertObject('alert1','alert1',' ',' ','errorIndElt1345880546404dIi15v_errorInd')];arr[arr.length] = arr['textareaElt1340794973527dIi15v_textarea']= [new AlertObject('alert1','alert1','m','! This field is required.','textareaElt1340794973527dIi15v_textarea')];arr[arr.length] = arr['errorIndElt1345880546424dIi15v_errorInd']= [new AlertObject('alert1','alert1',' ',' ','errorIndElt1345880546424dIi15v_errorInd')];arr[arr.length] = arr['buttonElt11340795124659dIi15v_button']= [new AlertObject('alert1','alert1',' ',' ','buttonElt11340795124659dIi15v_button')];arr[arr.length] = arr['buttonElt21340795161694dIi15v_button']= [new AlertObject('alert1','alert1',' ',' ','buttonElt21340795161694dIi15v_button')];arr[arr.length] = arr['buttonElt21340795216285dIi15v_button']= [new AlertObject('alert1','alert1',' ',' ','buttonElt21340795216285dIi15v_button')];function ExtensionObject(filetype,filesize,fileunit){this.filetype = filetype ;this.filesize= filesize;this.fileunit = fileunit ;}var extArr = new Array() ;
var rules = new Array();
// This method defines the rules
function ruleObject(name, value, effectedElementName){
	this.name = name ; 
	this.value = value ;
	this.effName = effectedElementName ;
}
rules[rules.length] = rules['a133_single_audit'] = new Array(new ruleObject('a133_single_audit', 'Yes', 'div_row_q22'));
rules[rules.length] = rules['where_a133_single_audit'] = new Array(new ruleObject('where_a133_single_audit', 'Yes', 'div_row_q23'));
rules[rules.length] = rules['curr_tax_filings'] = new Array(new ruleObject('curr_tax_filings', new Array('No', 'Exempt From Filing'), 'div_row_q12'));
rules[rules.length] = rules['irs'] = new Array(new ruleObject('irs', 'No', 'div_row_q10'), new ruleObject('irs', 'Yes', 'div_row_q13'));
rules[rules.length] = rules['org_reg_with_char'] = new Array(new ruleObject('org_reg_with_char', '', 'div_row_q7'));
rules[rules.length] = rules['orgExempt'] = new Array(new ruleObject('orgExempt', 'Yes', 'div_row_q2'),
		new ruleObject('orgExempt', 'No', 'div_row_q4'),
		new ruleObject('orgExempt', 'No', 'div_row_q5'),
		new ruleObject('orgExempt', 'No', 'div_row_q6'));
rules[rules.length] = rules['other_exempt'] = new Array(new ruleObject('other_exempt', '', 'div_row_q3'));
rules[rules.length] = rules['select_completed_audit'] = new Array(new ruleObject('select_completed_audit', 'Yes', 'div_row_q16'), 
		new ruleObject('select_completed_audit', 'Yes', 'div_row_q17'), 
		new ruleObject('select_completed_audit', 'No', 'div_row_q19'));
rules[rules.length] = rules['no_material_findings'] = new Array(new ruleObject('no_material_findings', 'Other', 'div_row_q20'));
rules[rules.length] = rules['where_material_findings'] = new Array(new ruleObject('where_material_findings', 'Yes', 'div_row_q18'));


var lastData = null;
/*on page load
Updated Method in R4
*/
$(document).ready(function() {
	
	if($("#textBoxElt_textbox_new").attr('readonly') == 'readonly'){
		$("#textBoxElt_textbox_new").attr('disabled', true);  
	}
	
	$('#textBoxElt_textbox_new').autoNumeric({
		vMax : '9999999999999999.99'
	});
	
	//sets the height of the span
	removePageGreyOut();
	$("span.label").each(function(){
		if($(this).height() < $(this).next().height())
			$(this).css({"height": $(this).next().height()});
	 });
	$('p:contains("Yes, my organization\'s registration with the Charities Bureau is up to date")')
		.attr("title", "Your Charities Bureau Registration must be up-to-date in order to complete your HHS Accelerator Application");
	$("input[name='org_reg_id']").fieldFormatter("XX-XX-XX");
	//defines the action performed when a button is clicked
	$("input[type='button'][id^='buttonElt']").click(function(e){
		pageGreyOut();
		var buttonName = $(this).attr("name");
		if(buttonName == "back"){
			var $self=$(this);
			var $form = $("#fb_divBl0ck1").closest('form');
			var isSame = false;
			data = $form.serializeArray();
			if(lastData != null){
				if($(lastData).compare($(data))){
					isSame = true;
				}
			}
			if(!isSame && lastData != null){
				e.preventDefault();
				$('<div id="dialogBox"></div>').appendTo('body')
	               .html('<div><h6>You have unsaved data. <br />If you would like to leave this screen without saving your data, click <b>OK</b>. <br/>If you would like to save your data, click <b>Cancel</b> and save your data.</h6></div>')
	               .dialog({
	                     modal: true, title: 'Unsaved Data', zIndex: 10000, autoOpen: true,
	                     width: 'auto', modal: true, resizable: false, draggable:false,
	                     dialogClass: 'dialogButtons',
	                     buttons: {
	                           OK: function () {
	                        	   //submits the form
	                        	   submitForm(buttonName);
	   							$(this).dialog("close");
	                           },//closes the dialogue
	                           Cancel: function () {
	                        	   $(this).dialog("close");
	                           }
	                     },
	                     close: function (event, ui) {
	                           $(this).remove();
	                     }
	               });
				$("div.dialogButtons div button:nth-child(2)").find("span").addClass("graybtutton");
			}else{
				submitForm(buttonName);
			}
		}else{
			submitForm(buttonName);
		}
	});
	$("input, select").change(function(){
		var changedNode = $(this);
		checkAndDisplay(changedNode, false);
	});
	$("select, input , textarea").each(function(){
		checkAndDisplay($(this), true);
	});
	$("div[id^='fb_divBl0ck']").each(function(){
		if($(this).children().size() <= 0){
			$(this).hide();
		}else if($(this).children().size() == 1){
			$(this).children().each(function(){
				if($(this).css("display").toLowerCase() == "none"){
					$(this).parent().hide().find("input, select, textarea").attr("disabled", true);
				}
			});
		}
	});
	var $form = $("#fb_divBl0ck1").closest('form');
	lastData = $form.serializeArray();
});
// this method validates the form
function validateForm(){
	var checkBoxGroup =  new Array();
	checkBoxGroup[0] = 'Religious_Organization';
	checkBoxGroup[1] = 'Educational_Institute';
	checkBoxGroup[2] = 'Patriotic';
	checkBoxGroup[3] = 'Historical_Societies';
	checkBoxGroup[4] = 'Relief';
	checkBoxGroup[5] = 'other_exempt';

	var isChecked = false;
	if(!$("input[name='"+checkBoxGroup[0]+"']").is(':disabled')){
		for(var i=0; i<checkBoxGroup.length; i++ ){
			if($("input[name='"+checkBoxGroup[i]+"']").is(":checked")){
				isChecked = true;
				break;
			}
		}
		if(!isChecked){
			if($(".errorMessages").length == 0){
				$("<ul class='errorMessages'></ul>").insertBefore("#fb_divBl0ck1");
			}
			$(".errorMessages").html("");
			$(".errorMessages").append("<li>Please select atleast one reason for exemption</li>");
			return false;
		}
	}
	return true;
}
//This method checks and displays the element selected 
function checkAndDisplay(changedNode, isOnLoad){
	var elementChangedName = changedNode.attr("name");
	hideUnhide(changedNode, isOnLoad);
}

var coveredItem = new Array();
//This method is used to hide/unhide the node
function hideUnhide(changedNode, isOnLoad){
	var elementChangedName = changedNode.attr("name");
	var ruleElts = rules[elementChangedName] ;
	if(ruleElts != null && typeof(ruleElts)!="undefined"){
		$.each(ruleElts, function(key) {
			ruleElt = ruleElts[key];
			if(ruleElt != null && typeof(ruleElt) != "undefined"){
				var requiredValue = ruleElt.value;
				var isArrayFlag = $.isArray(requiredValue);
				if(elementChangedName == "curr_tax_filings" && $("select[name='irs']").val() == "Yes"){
					changeIRS(elementChangedName, this, isOnLoad);
				}
				if((!isArrayFlag && requiredValue != "" && changedNode.val() ==  requiredValue) || (!isArrayFlag && requiredValue == "" && changedNode.is(":checked"))
						|| (isArrayFlag && $.inArray(changedNode.val(), requiredValue) >= 0)){
					$("div[name="+ruleElt.effName+"]").parent().show();
					if(!isOnLoad)
						$("div[name="+ruleElt.effName+"]").parent().find("input, select, textarea").attr("disabled", false);
					$("div[name="+ruleElt.effName+"]").parent().show().children().show();
					changeIRS(elementChangedName, this, isOnLoad);
					$("span.label").each(function(){
						if($(this).height() < $(this).next().height())
							$(this).css({"height": $(this).next().height()});
					 });
				}else{
					if((isOnLoad && $.inArray(ruleElt.effName, coveredItem)>=0) || !isOnLoad){
						$("div[name="+ruleElt.effName+"]").parent().hide().find("input, select, textarea").each(function(){
							if($(this).get(0).nodeName.toLowerCase() == "input"){
								if($(this).attr("type").toLowerCase() == "radio" || $(this).attr("type").toLowerCase() == "checkbox"){
									$(this).attr('checked', false);
								}else if($(this).attr("type").toLowerCase() != "password"){
									$(this).val("");
								}
							}else if($(this).get(0).nodeName.toLowerCase() == "textarea"){
								$(this).html("");
							}else if($(this).get(0).nodeName.toLowerCase() == "select"){
								$(this).val(" ");
							}
							hideUnhide($(this), isOnLoad);
						}).attr("disabled", true);
					}
					if(isOnLoad && $.inArray(ruleElt.effName, coveredItem) == -1){
						coveredItem[coveredItem.length] = ruleElt.effName;
					}
				}
			}
		});
	}
}
// This method changes the IRS 
function changeIRS(elementChangedName, element, isOnLoad){
	if((elementChangedName == "curr_tax_filings" || elementChangedName  == "irs") && $("select[name='irs']").val() == "Yes"){
		if((elementChangedName == "curr_tax_filings" || elementChangedName  == "irs")  &&  $("select[name='curr_tax_filings']").val() == "Exempt From Filing"){
			$("div[name='div_row_q13']").parent().hide().find("input, select, textarea").each(function(){
				if($(this).get(0).nodeName.toLowerCase() == "input"){
					if($(this).attr("type").toLowerCase() == "radio" || $(this).attr("type").toLowerCase() == "checkbox"){
						$(this).attr('checked', false);
					}else if($(this).attr("type").toLowerCase() != "password"){
						$(this).val("");
					}
				}else if($(this).get(0).nodeName.toLowerCase() == "textarea"){
					$(this).html("");
				}else if($(this).get(0).nodeName.toLowerCase() == "select"){
					$(this).val(" ");
				}
				hideUnhide($(this), isOnLoad);
			}).attr("disabled", true);
		}else{
			$("div[name='div_row_q13']").parent().show();
			if(!isOnLoad)
				$("div[name='div_row_q13']").parent().find("input, select, textarea").attr("disabled", false);
			$("div[name='div_row_q13']").parent().show().children().show();
		}
	}
}
// This method compares the value
jQuery.fn.compare = function(t) {
	if (this.length != t.length) { return false; }
	var a = this.sort(),
	b = t.sort();
	for (var i = 0; t[i]; i++) {
		if (a[i].name != b[i].name || a[i].value != b[i].value) { 
			return false;
		}
	}
	return true;
};